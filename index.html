<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Agentic Test Case Generator</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: 'Segoe UI', Tahoma, sans-serif;
      background: #f4f6fa;
      color: #333;
    }

    header {
      background: #00163a;
      color: white;
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 16px 40px;
    }
    header img { height: 40px; }
    header h1 { font-size: 18px; font-weight: 600; }

    .container { max-width: 900px; margin: 30px auto; }

    details {
      background: white;
      border-radius: 8px;
      margin-bottom: 18px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.08);
      overflow: hidden;
    }
    summary {
      cursor: pointer;
      list-style: none;
      padding: 18px 24px;
      font-size: 16px;
      font-weight: 600;
      color: #00163a;
      display: flex;
      justify-content: space-between;
      background: #f8f9fc;
    }
    summary:hover { background: #eaf0ff; }
    details[open] summary { border-bottom: 1px solid #e1e5ee; }

    .section-content { padding: 24px; line-height: 1.6; }

    button {
      background: #00163a;
      color: #fff;
      border: none;
      padding: 10px 20px;
      border-radius: 4px;
      cursor: pointer;
      font-size: 14px;
      font-weight: 500;
      transition: background 0.3s ease;
    }
    button:hover:not(:disabled) { background: #002b6b; }
    button:disabled { background: #999; cursor: not-allowed; }

    input[type="file"], input[type="text"] {
      width: 100%;
      padding: 10px;
      border: 1px solid #ccc;
      border-radius: 4px;
      font-size: 14px;
      margin-bottom: 12px;
    }

    .form-group { margin-bottom: 16px; }
    label { display: block; margin-bottom: 6px; font-weight: 500; color: #444; }

    .response { margin-top: 14px; padding: 12px; border-radius: 4px; font-size: 14px; }
    .success { background: #dff6e0; border: 1px solid #b8e1b4; color: #1c602b; }
    .error { background: #fbe3e4; border: 1px solid #f5b6b8; color: #842029; }
    .info { background: #e6f2ff; border: 1px solid #b6dcff; color: #084298; }

    .btn-group { display: flex; gap: 10px; align-items: center; }
  </style>
</head>

<body>
  <header>
    <img src="data:image/png;base64,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" alt="Company Logo">
    <h1>Agentic Test Case Generator</h1>
  </header>

  <div class="container">

  <details>
      <summary>üìñ User Manual</summary>
      <div class="section-content">
        <h3>üöÄ Getting Started with Agentic Test Case Generator</h3>
        <p>Welcome to the Agentic Test Case Generator by <strong>rSTAR Technologies</strong> ‚Äì your AI-powered assistant for fast, smart, and structured test case generation. Follow these steps to make the most out of the tool:</p>

        <h4>üìÅ Step 1: Download Excel Template & Prepare Your Input Excel File</h4>
        <p>Your Excel sheet should contain the following mandatory columns:</p>
        <ul>
          <li><strong>User Story</strong> e.g., ‚ÄúAs a user, I want to reset my password via email.‚Äù</li>
          <li><strong>Acceptance Criteria</strong> e.g., ‚ÄúUser should receive a reset link when a valid email is entered.‚Äù</li>
        </ul>

        <p>You can optionally include these additional columns to enhance test case accuracy and relevance:</p>

        <table>
          <tr><th>Column Name</th><th>Description</th></tr>
          <tr><td>Priority</td><td>High / Medium / Low</td></tr>
          <tr><td>Feature/Module</td><td>Functional area</td></tr>
          <tr><td>Preconditions</td><td>Any setup needed</td></tr>
          <tr><td>Generic Test Data</td><td>Sample input</td></tr>
          <tr><td>Test Environment</td><td>Browser, OS, device</td></tr>
          <tr><td>Risk Level</td><td>Risk category</td></tr>
          <tr><td>Comments/Notes</td><td>Additional context</td></tr>
        </table>

        <h4>üß© Step 2: Formatting Tips</h4>
        <p>‚úÖ <strong>Recommended Format:</strong></p>
        <table>
          <tr><th>User Story</th><th>Acceptance Criteria</th></tr>
          <tr><td>As a user, I want to reset my password</td><td>User should receive a reset link on valid email</td></tr>
          <tr><td>As a user, I want to reset my password</td><td>Error shown when email field is empty</td></tr>
        </table>

        <h4>‚öôÔ∏è Step 3: Upload & Generate</h4>
        <ul>
          <li>Go to the <strong>Upload Excel</strong> section.</li>
          <li>Click <em>Browse files</em> and select your Excel file.</li>
          <li>Click <strong>Generate Test Cases</strong>.</li>
        </ul>

        <h4>üì§ Output Format</h4>
        <p>Your generated test cases will include: S.No., User Story, Acceptance Criteria, Test Type, Test Case Title, Steps, Expected Result, Input Data, Priority, Status, Comments</p>

        <h4>üí¨ Need Help?</h4>
        <p>Reach out to the <strong>rSTAR QA Team</strong> for assistance.</p>
      </div>
    </details>

    <details>
      <summary>üìò Excel Template</summary>
      <div class="section-content">
        <p>Download the Excel template, fill it in, and upload to generate test cases.</p><br>
        <button onclick="downloadTemplate()">‚¨áÔ∏è Download Excel Template</button>
        <div id="templateResponse"></div>
      </div>
    </details>

    <details>
      <summary>‚öôÔ∏è Generate and Download Test Cases</summary>
      <div class="section-content">
        <div class="form-group">
          <label>Upload Input Excel File</label>
          <input type="file" id="generateFile" accept=".xlsx">
        </div>
        <div class="btn-group">
          <button id="generateBtn" onclick="generateTestCases()">Generate Test Cases</button>
          <button id="downloadBtn" onclick="downloadGeneratedFile()" disabled>‚¨áÔ∏è Download Test Cases</button>
        </div>
        <div id="generateResponse"></div>
      </div>
    </details>

    <details>
      <summary>‚òÅÔ∏è Upload to AzureDevOps</summary>
      <div class="section-content">
        <div class="form-group">
          <label>Upload Generated TCS Excel File</label>
          <input type="file" id="uploadFile" accept=".xlsx">
        </div>
        <div class="form-group"><label>Organization</label><input type="text" id="org" placeholder="e.g., exelontfs"></div>
        <div class="form-group"><label>Project</label><input type="text" id="project" placeholder="e.g., Gen AI Platform"></div>
        <div class="form-group"><label>PAT Token</label><input type="text" id="pat" placeholder="Your Azure DevOps PAT"></div>
        <div class="form-group"><label>Plan Name</label><input type="text" id="planName" placeholder="e.g., ASAT"></div>
        <div class="form-group"><label>Suite Name</label><input type="text" id="suiteName" placeholder="e.g., LOGIN"></div>
        <button onclick="uploadTestCases()">Upload to ADO</button>
        <div id="uploadResponse"></div>
      </div>
    </details>

  </div>

  <script>
    const API_BASE = 'http://localhost:5000';
    let generatedFilename = null;

    async function generateTestCases() {
      const fileInput = document.getElementById('generateFile');
      const responseDiv = document.getElementById('generateResponse');
      const downloadBtn = document.getElementById('downloadBtn');
      downloadBtn.disabled = true;
      if (!fileInput.files[0]) {
        responseDiv.innerHTML = '<div class="response error">Please select a file</div>';
        return;
      }

      const formData = new FormData();
      formData.append('file', fileInput.files[0]);

      try {
        responseDiv.innerHTML = '<div class="response info">Generating test cases...</div>';
        const res = await fetch(`${API_BASE}/generate`, { method: 'POST', body: formData });
        const data = await res.json();

        if (data.status === 'success') {
          generatedFilename = data.filename;
          responseDiv.innerHTML = `<div class="response success">
            ‚úÖ Success! Test Cases Generated: ${data.count}<br>
            Filename: <strong>${data.filename}</strong>
          </div>`;
          downloadBtn.disabled = false;
        } else {
          responseDiv.innerHTML = `<div class="response error">‚ùå ${data.message}</div>`;
        }
      } catch (e) {
        responseDiv.innerHTML = `<div class="response error">‚ùå ${e.message}</div>`;
      }
    }

    function downloadGeneratedFile() {
      if (!generatedFilename) return;
      window.location.href = `${API_BASE}/download?filename=${encodeURIComponent(generatedFilename)}`;
    }

    async function downloadTemplate() {
      const resDiv = document.getElementById('templateResponse');
      try {
        window.location.href = `${API_BASE}/download-template`;
        resDiv.innerHTML = '<div class="response success">‚úÖ Template download started!</div>';
      } catch (e) { resDiv.innerHTML = `<div class="response error">‚ùå ${e.message}</div>`; }
    }

    async function uploadTestCases() {
      const fileInput = document.getElementById('uploadFile');
      const org = document.getElementById('org').value.trim();
      const project = document.getElementById('project').value.trim();
      const pat = document.getElementById('pat').value.trim();
      const planName = document.getElementById('planName').value.trim();
      const suiteName = document.getElementById('suiteName').value.trim();
      const resDiv = document.getElementById('uploadResponse');
      if (!fileInput.files[0] || !org || !project || !pat || !planName || !suiteName)
        return resDiv.innerHTML = '<div class="response error">Please fill all required fields</div>';

      const formData = new FormData();
      formData.append('file', fileInput.files[0]);
      formData.append('org', org);
      formData.append('project', project);
      formData.append('pat', pat);
      formData.append('plan_name', planName);
      formData.append('suite_name', suiteName);

      try {
        resDiv.innerHTML = '<div class="response info">Uploading to Azure DevOps...</div>';
        const res = await fetch(`${API_BASE}/upload`, { method: 'POST', body: formData });
        const data = await res.json();
        resDiv.innerHTML = `<div class="response ${data.status === 'success' ? 'success' : 'error'}">
          ${data.status === 'success' ? '‚úÖ Upload Complete' : '‚ö†Ô∏è Upload Error'}<br>
          Uploaded: ${data.uploaded_count || 0} | Failed: ${data.failed_count || 0}
        </div>`;
      } catch (e) {
        resDiv.innerHTML = `<div class="response error">‚ùå ${e.message}</div>`;
      }
    }
  </script>
</body>
</html>
